<-- FULL CLEANED CODE FROM ABOVE WILL BE INSERTED HERE -->